#!/bin/env bash

set -euo pipefail

# --------------------------------------------------------

DEBUG=1

CLI_TITLE='IvoryTusk CLI'
CLI_PURPOSE="Manage the envs of laravel like laragon but with just an a CLI"

CLI_NAME_COMMAND="basename \$0"
CLI_VERSION_COMMAND="cat \$WORKDIR/VERSION"
# --------------------------------------------------------

WORKDIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" >/dev/null 2>&1 && pwd)"
export WORKDIR

# --------------------------------------------------------

. "$WORKDIR"/modules/dependencies
. "$WORKDIR"/modules/common
. "$WORKDIR"/modules/colors
. "$WORKDIR"/modules/resolver

CLI_NAME=$(eval "$CLI_NAME_COMMAND")
CLI_VERSION=$(eval "$CLI_VERSION_COMMAND")

# --------------------------------------------------------

cli_help() {
    title "$CLI_TITLE - ${GREEN}$CLI_NAME${RESET} - $CLI_VERSION"
    subtitle "${ITALIC}$CLI_PURPOSE"
    echo
    show_param_title "Usage:" "$CLI_NAME [command] [options]"
    show_commands_help
}

# --------------------------------------------------------

if [ "$#" -eq 0 ] || [ "$1" == "--help" ] || [ "$1" == "-h" ]; then
    cli_help
    [ "$#" -eq 0 ] && exit 1
    exit 0
fi

# --------------------------------------------------------

# TODO:
# - [ ] Show a generic help
# - [ ] Create a command interface, as an interface to interact with the artisan or other containers
# - [ ] Add the support to `hosts.d` directory, to add a virtual domains

# TODO COMMANDS:
# - [ ] Create a new dev environment
# - [ ] Remove a dev environment
# - [ ] Start a dev environment
# - [ ] Stop a dev environment
# - [ ] Restart a dev environment
# - [ ] show status of dev environment
